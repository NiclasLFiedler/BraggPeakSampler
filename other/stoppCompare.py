import numpy as np
import matplotlib.pyplot as plt

ICRU_E = [1.000E-03, 1.500E-03, 2.000E-03, 2.500E-03, 3.000E-03, 4.000E-03, 5.000E-03, 6.000E-03, 7.000E-03, 8.000E-03, 9.000E-03, 1.000E-02, 1.250E-02, 1.500E-02, 1.750E-02, 2.000E-02, 2.250E-02, 2.500E-02, 2.750E-02, 3.000E-02, 3.500E-02, 4.000E-02, 4.500E-02, 5.000E-02, 5.500E-02, 6.000E-02, 6.500E-02, 7.000E-02, 7.500E-02, 8.000E-02, 8.500E-02, 9.000E-02, 9.500E-02, 1.000E-01, 1.250E-01, 1.500E-01, 1.750E-01, 2.000E-01, 2.250E-01, 2.500E-01, 2.750E-01, 3.000E-01, 3.500E-01, 4.000E-01, 4.500E-01, 5.000E-01, 5.500E-01, 6.000E-01, 6.500E-01, 7.000E-01, 7.500E-01, 8.000E-01, 8.500E-01, 9.000E-01, 9.500E-01, 1.000E+00, 1.250E+00, 1.500E+00, 1.750E+00, 2.000E+00, 2.250E+00, 2.500E+00, 2.750E+00, 3.000E+00, 3.500E+00, 4.000E+00, 4.500E+00, 5.000E+00, 5.500E+00, 6.000E+00, 6.500E+00, 7.000E+00, 7.500E+00, 8.000E+00, 8.500E+00, 9.000E+00, 9.500E+00, 1.000E+01, 1.250E+01, 1.500E+01, 1.750E+01, 2.000E+01, 2.500E+01, 2.750E+01, 3.000E+01, 3.500E+01, 4.000E+01, 4.500E+01, 5.000E+01, 5.500E+01, 6.000E+01, 6.500E+01, 7.000E+01, 7.500E+01, 8.000E+01, 8.500E+01, 9.000E+01, 9.500E+01, 1.000E+02, 1.250E+02, 1.500E+02, 1.750E+02, 2.000E+02, 2.250E+02, 2.500E+02, 2.750E+02, 3.000E+02, 3.500E+02, 4.000E+02, 4.500E+02, 5.000E+02, 5.500E+02, 6.000E+02, 6.500E+02, 7.000E+02, 7.500E+02, 8.000E+02, 8.500E+02, 9.000E+02, 9.500E+02, 1.000E+03, 1.500E+03, 2.000E+03, 2.500E+03, 3.000E+03, 4.000E+03, 5.000E+03, 6.000E+03, 7.000E+03, 8.000E+03, 9.000E+03, 1.000E+04]


ICRUstoppingTotal_H2o = [1.769E+02 , 1.984E+02 , 2.184E+02 , 2.370E+02 , 2.544E+02 , 2.864E+02 , 3.153E+02 , 3.420E+02 , 3.667E+02 , 3.900E+02 , 4.120E+02 , 4.329E+02 , 4.745E+02 , 5.110E+02 , 5.437E+02 , 5.733E+02 , 6.001E+02 , 6.245E+02 , 6.467E+02 , 6.671E+02 , 7.028E+02 , 7.324E+02 , 7.569E+02 , 7.768E+02 , 7.927E+02 , 8.050E+02 , 8.142E+02 , 8.205E+02 , 8.243E+02 , 8.260E+02 , 8.258E+02 , 8.239E+02 , 8.206E+02 , 8.161E+02 , 7.814E+02 , 7.371E+02 , 6.969E+02 , 6.613E+02 , 6.294E+02 , 6.006E+02 , 5.744E+02 , 5.504E+02 , 5.080E+02 , 4.719E+02 , 4.406E+02 , 4.132E+02 , 3.891E+02 , 3.680E+02 , 3.492E+02 , 3.325E+02 , 3.175E+02 , 3.039E+02 , 2.917E+02 , 2.805E+02 , 2.702E+02 , 2.608E+02 , 2.229E+02 , 1.957E+02 , 1.749E+02 , 1.586E+02 , 1.454E+02 , 1.344E+02 , 1.251E+02 , 1.172E+02 , 1.042E+02 , 9.404E+01 , 8.586E+01 , 7.911E+01 , 7.343E+01 , 6.858E+01 , 6.438E+01 , 6.071E+01 , 5.747E+01 , 5.460E+01 , 5.202E+01 , 4.969E+01 , 4.759E+01 , 4.567E+01 , 3.815E+01 , 3.292E+01 , 2.905E+01 , 2.607E+01 , 2.175E+01 , 2.013E+01 , 1.876E+01 , 1.656E+01 , 1.488E+01 , 1.354E+01 , 1.245E+01 , 1.154E+01 , 1.078E+01 , 1.013E+01 , 9.559E+00 , 9.063E+00 , 8.625E+00 , 8.236E+00 , 7.888E+00 , 7.573E+00 , 7.289E+00 , 6.192E+00 , 5.445E+00 , 4.903E+00 , 4.492E+00 , 4.170E+00 , 3.911E+00 , 3.698E+00 , 3.520E+00 , 3.241E+00 , 3.032E+00 , 2.871E+00 , 2.743E+00 , 2.640E+00 , 2.556E+00 , 2.485E+00 , 2.426E+00 , 2.376E+00 , 2.333E+00 , 2.296E+00 , 2.264E+00 , 2.236E+00 , 2.211E+00 , 2.070E+00 , 2.021E+00 , 2.004E+00 , 2.001E+00 , 2.012E+00 , 2.031E+00 , 2.052E+00 , 2.072E+00 , 2.091E+00 , 2.109E+00 , 2.126E+00]

stoppingGeant4H2O = [133.7, 163.515, 189.098, 211.438, 231.589, 267.5, 299, 327.599, 353.775, 378.199, 401.393, 422.9, 467.461, 503.591, 536.632, 567.3, 594.982, 619.845, 642.31, 662.784, 698.814, 729.001, 753.857, 774, 790.099, 802.611, 811.915, 818.374, 822.333, 824.094, 823.936, 822.123, 818.904, 814.5, 780.024, 736.009, 694.865, 658.499, 625.508, 595.533, 568.288, 543.527, 500.46, 464.298, 433.303, 406.5, 383.06, 362.386, 344.027, 327.635, 312.943, 299.704, 287.693, 276.739, 266.685, 257.4, 219.948, 193.427, 173.13, 156.899, 143.603, 132.71, 123.689, 116.01, 103.297, 93.1895, 85.0622, 78.4199, 72.8141, 68.0052, 63.8394, 60.2008, 57.0051, 54.171, 51.6269, 49.3275, 47.2355, 45.32, 37.7922, 32.6955, 28.8883, 25.8898, 21.5364, 19.9617, 18.6417, 16.4825, 14.7899, 13.4538, 12.38, 11.4823, 10.7192, 10.0652, 9.50038, 9.00955, 8.57818, 8.19351, 7.84778, 7.53481, 7.25, 6.13179, 5.35621, 4.79354, 4.35966, 4.01743, 3.74815, 3.53393, 3.35747, 3.07396, 2.85695, 2.69086, 2.56143, 2.45567, 2.36771, 2.29417, 2.23232, 2.18005, 2.13532, 2.09638, 2.06215, 2.03177, 2.00452, 1.84114, 1.76976, 1.73124, 1.71056, 1.6892, 1.67997, 1.67655, 1.67569, 1.67603, 1.67662, 1.67715]

stoppingGeant4H2OTotal = [177.321, 199.515, 218.501, 237.016, 254.431, 286.539, 315.323, 342.103, 366.922, 390.116, 412.403, 433.216, 476.226, 511.164, 543.287, 573.282, 600.445, 624.848, 646.964, 667.134, 702.668, 732.464, 757.008, 776.877, 792.778, 805.107, 814.282, 820.607, 824.417, 826.077, 825.803, 823.914, 820.626, 816.134, 781.389, 737.174, 695.895, 659.41, 626.331, 596.28, 568.981, 544.138, 501.024, 464.8, 433.756, 406.91, 383.437, 362.754, 344.354, 327.945, 313.245, 299.974, 287.965, 276.982, 266.909, 257.624, 219.948, 193.4, 173.132, 156.9, 143.603, 132.711, 123.688, 116, 103.298, 93.19, 85.0624, 78.42, 72.8131, 68.01, 63.8376, 60.2002, 57.0076, 54.17, 51.6299, 49.3268, 47.2328, 45.32, 37.7923, 32.69, 28.8886, 25.89, 21.5364, 19.9615, 18.64, 16.4825, 14.79, 13.4539, 12.38, 11.4822, 10.72, 10.0649, 9.50028, 9.00998, 8.578, 8.19399, 7.8477, 7.53456, 7.25, 6.14566, 5.417, 4.8843, 4.47, 4.14131, 3.88183, 3.67493, 3.504, 3.22906, 3.018, 2.85654, 2.731, 2.62866, 2.544, 2.47334, 2.41441, 2.36503, 2.323, 2.28688, 2.25528, 2.22753, 2.203, 2.065, 2.017, 1.99957, 1.998, 2.01, 2.029, 2.05001, 2.07057, 2.09007, 2.10802, 2.13084]


stoppinglungGeant4 = [207.317, 236.938, 262.307, 286.276, 308.601, 349.292, 385.741, 419.294, 450.471, 479.523, 507.014, 533.162, 584.034, 628.145, 667.156, 701.991, 733.253, 761.366, 786.757, 809.671, 849.11, 881.203, 905.603, 924.495, 938.794, 949.126, 956.046, 960.024, 961.469, 960.754, 958.205, 954.076, 948.62, 942.045, 898.031, 845.477, 792.3, 742.123, 696.341, 655.237, 618.598, 585.991, 530.978, 486.684, 450.376, 420.068, 394.349, 372.2, 352.88, 335.841, 320.67, 307.052, 294.744, 283.547, 273.307, 263.896, 225.987, 198.734, 177.943, 161.475, 147.636, 136.203, 126.376, 117.985, 104.378, 94.168, 85.9249, 79.1048, 73.3741, 68.4849, 64.2606, 60.5722, 57.3219, 54.4276, 51.8372, 49.5043, 47.3913, 45.468, 37.9436, 32.715, 28.8533, 25.8772, 21.5757, 19.9665, 18.6046, 16.4218, 14.7465, 13.4177, 12.3366, 11.439, 10.6811, 10.0324, 9.47048, 8.97886, 8.54495, 8.15905, 7.81353, 7.5023, 7.22044, 6.13329, 5.39319, 4.85649, 4.44951, 4.13044, 3.87377, 3.66302, 3.48705, 3.21047, 3.00374, 2.84409, 2.71767, 2.61556, 2.53176, 2.46209, 2.40352, 2.35385, 2.31139, 2.27485, 2.24325, 2.21504, 2.18996, 2.05142, 2.00513, 1.99145, 1.99159, 2.00765, 2.03004, 2.05293, 2.07467, 2.09488, 2.11345, 2.13055]

Geant4PWO = [30.6453, 36.3445, 41.1871, 45.4843, 49.3927, 56.3776, 62.5641, 68.1969, 73.3795, 78.2047, 82.7814, 87.1078, 95.8031, 103.442, 110.345, 116.636, 122.415, 127.752, 132.702, 137.31, 145.631, 152.918, 159.323, 164.958, 169.911, 174.256, 178.048, 181.339, 184.175, 186.599, 188.65, 190.357, 191.75, 192.858, 194.939, 192.934, 188.544, 182.87, 176.621, 170.239, 163.987, 158.014, 147.152, 137.787, 129.776, 122.907, 116.973, 111.803, 107.252, 103.21, 99.5876, 96.3166, 93.3418, 90.6184, 88.1111, 85.7909, 76.2303, 69.1035, 63.461, 58.8365, 55.163, 51.998, 48.8877, 46.1436, 41.5807, 38.5634, 35.9551, 33.679, 31.683, 29.9395, 28.4142, 27.054, 25.8426, 24.7448, 23.7486, 22.8366, 22.0015, 21.2338, 18.1463, 15.9268, 14.242, 12.9174, 10.9585, 10.2118, 9.57361, 8.53863, 7.72878, 7.07857, 6.54213, 6.09747, 5.71979, 5.39466, 5.1136, 4.86604, 4.64642, 4.45015, 4.27359, 4.11391, 3.96883, 3.40435, 3.01569, 2.73141, 2.51462, 2.34358, 2.20541, 2.09166, 1.99637, 1.8463, 1.73443, 1.648, 1.57961, 1.52471, 1.47979, 1.44256, 1.4114, 1.38511, 1.36277, 1.34369, 1.32731, 1.3132, 1.30102, 1.24097, 1.22999, 1.2347, 1.24543, 1.27219, 1.2992, 1.32421, 1.34687, 1.36779, 1.38649, 1.40354]

comp = [ICRUstoppingTotal_H2o[idx]/stoppingGeant4H2OTotal[idx] for idx, value in enumerate(ICRU_E)]
comp2 = [ICRUstoppingTotal_H2o[idx]/stoppingGeant4H2O[idx] for idx, value in enumerate(ICRU_E)]
plt.figure(figsize=(10, 6)) 

#plt.plot(ICRU_E, comp, label='ICRU H2O / Geant4 H2O', marker='o', markersize=3, linestyle='-', color='blue')
#plt.plot(ICRU_E, comp2, label='ICRU H2O / Geant4 H2O Total', marker='o', markersize=3, linestyle='-', color='orange')        
#plt.plot(ICRU_E, stoppingGeant4H2O, label='Geant4 H2O', marker='x', markersize=3, linestyle='--', color='red')
plt.plot(ICRU_E, ICRUstoppingTotal_H2o, label='ICRU H2O', marker='s', markersize=3, linestyle=':', color='green')
plt.plot(ICRU_E, stoppingGeant4H2OTotal, label='Geant4 H2O Total', marker='s', markersize=3, linestyle=':', color='orange')
plt.grid(True, which='both', linestyle='--', linewidth=0.5)
plt.xlabel('Energy (MeV)')
plt.ylabel('Stopping Power (MeV cm$^{-1}$)')
plt.title('Comparison of Stopping Power for H2O')
plt.legend()
plt.xscale('log')
plt.yscale('log')
plt.show()

plt.plot(ICRU_E, comp, label='ICRU H2O / Geant4 H2O', marker='o', markersize=3, linestyle='-', color='blue')
plt.grid(True, which='both', linestyle='--', linewidth=0.5)
plt.xlabel('Energy (MeV)')
plt.ylabel('Ratio (ICRU H2O / Geant4 H2O)')
plt.title('Ratio of ICRU H2O to Geant4 H2O Stopping Power')
plt.legend()
plt.xscale('log')
plt.yscale('log')
plt.show()

